(function(n){function l(t){var r=n("#routing-instance-grid"),u=f(t),o=r.find("tbody"),s=JSON.stringify(u),i=n.Deferred();return n.ajax({url:"GetAttachmentSetRoutingInstancesGridData",contentType:"application/json; charset=utf-8",type:"POST",data:s,success:function(n){o.html(n);e();i.resolve()}}),i.promise()}function t(t){var r=n("#bgp-ip-network-inbound-policy-grid"),u=a(t),f=JSON.stringify(u),i=n.Deferred();return n.ajax({url:"GetBgpIpNetworkInboundPolicyGridData",contentType:"application/json; charset=utf-8",type:"POST",data:f,success:function(n){var t=r.find("tbody");t.html(n);e();i.resolve()}}),i.promise()}function i(t){var r=n("#bgp-ip-network-outbound-policy-grid"),u=v(t),f=JSON.stringify(u),i=n.Deferred();return n.ajax({url:"GetBgpIpNetworkOutboundPolicyGridData",contentType:"application/json; charset=utf-8",type:"POST",data:f,success:function(n){var t=r.find("tbody");t.html(n);e();i.resolve()}}),i.promise()}function f(t){typeof t=="undefined"&&(t=[]);var i=n("#routing-instance-grid"),r=i.find("tbody tr");return r.each(function(){var i=n(this),r=i.data("name"),u=i.data("local-ip-routing-preference"),f=i.data("advertised-ip-routing-preference");t.push({RoutingInstanceName:r,LocalIpRoutingPreference:u,AdvertisedIpRoutingPreference:f})}),t}function a(t){var i,r,u;return typeof t=="undefined"&&(t=[]),i=n("#bgp-ip-network-inbound-policy-grid").find("tbody tr"),i.each(function(){var i=n(this),r=i.data("tenant-id"),u=i.data("cidr-name"),f=i.data("local-ip-routing-preference"),e=i.data("add-to-all-bgp-peers-in-attachment-set"),o=i.data("ipv4-peer-address");t.push({TenantId:r,TenantIpNetworkCidrName:u,AddToAllBgpPeersInAttachmentSet:e,Ipv4PeerAddress:o,LocalIpRoutingPreference:f})}),r=f(),u=r.map(function(n){return n.RoutingInstanceName}),{RoutingInstanceNames:u,VpnTenantIpNetworkInRequests:t}}function v(t){var i,r,u;return typeof t=="undefined"&&(t=[]),i=n("#bgp-ip-network-outbound-policy-grid").find("tbody tr"),i.each(function(){var i=n(this),r=i.data("tenant-id"),u=i.data("tenant-name"),f=i.data("cidr-name"),e=i.data("advertised-ip-routing-preference"),o=i.data("add-to-all-bgp-peers-in-attachment-set"),s=i.data("ipv4-peer-address");t.push({TenantId:r,TenantName:u,TenantIpNetworkCidrName:f,AddToAllBgpPeersInAttachmentSet:o,Ipv4PeerAddress:s,AdvertisdIpRoutingPreference:e})}),r=f(),u=r.map(function(n){return n.RoutingInstanceName}),{RoutingInstanceNames:u,VpnTenantIpNetworkOutRequests:t}}function e(){var t=n("#form");t.removeData("validator");t.removeData("unobtrusiveValidation");n.validator.unobtrusive.parse("#form")}var o=n("#RoutingInstance"),s=o[0];n("#addRoutingInstance").on("click",function(){var f=n("#routing-instance-grid"),r;if(s.value!==null&&s.value!==""){var e=o.find(":selected"),u=e.data("name"),h=f.find('td > input[type="text"]').filter(function(){return this.value===u}).length>0;h?n("#duplicateItemModal").modal():(r=[],r.push({RoutingInstanceName:u}),l(r).then(function(){t();i()}))}});n("#routing-instance-grid").on("click",".mind-grid-delete-row",function(){var r=n(this).data("row-id"),u=n("#routing-instance-grid-row_"+r);u.remove();l().then(function(){t();i()})});n("#addInboundIpNetwork").on("click",function(){var e=n("#bgp-ip-network-inbound-policy-grid"),o=n("#TenantId"),s=o[0],r=n("#InboundIpNetwork"),u=r[0],i;if(u.value!==null&&u.value!==""){var h=r.find(":selected"),f=h.data("cidr-name"),c=e.find('td > input[type="text"]').filter(function(){return this.value===f}).length>0;c?n("#duplicateItemModal").modal():(i=[],i.push({TenantId:s.value,TenantIpNetworkCidrName:f}),t(i))}});n("#addOutboundIpNetwork").on("click",function(){var o=n("#bgp-ip-network-outbound-policy-grid"),s=n("#RemoteTenantId"),h=s[0],r=n("#OutboundIpNetwork"),u=r[0],t;if(u.value!==null&&u.value!==""){var f=r.find(":selected"),e=f.data("cidr-name"),c=f.data("tenant-name"),l=o.find('td > input[type="text"]').filter(function(){return this.value===e}).length>0;l?n("#duplicateItemModal").modal():(t=[],t.push({TenantId:h.value,TenantName:c,TenantIpNetworkCidrName:e}),i(t))}});n("#bgp-ip-network-inbound-policy-grid").on("click",".mind-grid-delete-row",function(){var i=n(this).data("row-id"),r=n("#bgp-ip-network-inbound-policy-grid-row_"+i);r.remove();t()});n("#bgp-ip-network-outbound-policy-grid").on("click",".mind-grid-delete-row",function(){var t=n(this).data("row-id"),r=n("#bgp-ip-network-outbound-policy-grid-row_"+t);r.remove();i()});n(".mind-grid").on("change",".mind-grid-checkbox",function(){this.value=this.checked});var h=n("#RemoteTenantId"),r=h[0],c=n("#OutboundIpNetwork"),u=c[0];u.disabled=!0;h.on("change",function(){r.value===null||r.value===""?(u.selectedIndex=0,u.disabled=!0):Mind.Utilities.populateElement(c,"TenantIpNetworks",{tenantId:r.value})})})(jQuery);