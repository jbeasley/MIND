(function(n){function e(t){var r=n("#attachment-set-grid"),u=l(t),f=r.find("tbody"),e=JSON.stringify(u),i=n.Deferred();return n.ajax({url:"GetVpnAttachmentSetsGridData",contentType:"application/json; charset=utf-8",type:"POST",data:e,success:function(n){f.html(n);a();i.resolve()}}),i.promise()}function l(t){typeof t=="undefined"&&(t=[]);var i=n("#attachment-set-grid"),r=i.find("tbody tr");return r.each(function(){var i=n(this),r=i.data("name"),f=i.data("tenant-name"),e=i.data("is-hub"),o=i.data("region"),s=i.data("attachment-redundancy");t.push({VpnTopologyType:u.value,AttachmentSetName:r,tenantName:f,IsHub:e,Region:o,AttachmentRedundancy:s})}),t}function a(){var t=n("#form");t.removeData("validator");t.removeData("unobtrusiveValidation");n.validator.unobtrusive.parse("#form")}var i=n("#AttachmentSet"),t=i[0],o=n("#TopologyType"),u=o[0];n("#addAttachmentSet").on("click",function(){var s=n("#attachment-set-grid"),f;if(t.value!==null&&t.value!==""){var r=i.find(":selected"),o=r.data("name"),h=r.data("tenant-name"),c=r.data("attachment-redundancy"),l=r.data("region-name"),a=s.find('td > input[type="text"]').filter(function(){return this.value===o}).length>0;a?n("#duplicateItemModal").modal():(f=[],f.push({VpnTopologyType:u.value,AttachmentSetName:o,tenantName:h,region:l,AttachmentRedundancy:c}),e(f))}});n("#attachment-set-grid").on("click",".mind-grid-delete-row",function(){var t=n(this).data("row-id"),i=n("#attachment-set-grid-row_"+t);i.remove();e()});n(".mind-grid").on("change",".mind-grid-checkbox",function(){this.value=this.checked;var t=n(this).parents("tr");t.data("is-hub",this.value)});var s=n("#TenancyType"),h=n("#TenantId"),c=h[0],r=n("#TenantName"),f=r[0];s.on("change",function(){t.selectedIndex=0;t.disabled=!0;this.value===null||this.value===""?(f.selectedIndex=0,f.disabled=!0):Mind.Utilities.populateElement(r,"ParticipantTenants",{ownerTenantId:c.value,tenancyType:this.value})});r.on("change",function(){this.value===null||this.value===""?(t.selectedIndex=0,t.disabled=!0):Mind.Utilities.populateElement(i,"AttachmentSets",{tenantName:this.value})})})(jQuery);